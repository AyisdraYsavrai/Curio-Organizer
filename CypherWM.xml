<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Sunday, March 16, 2014, 11:57 AM -->
<!-- MuClient version 4.91 -->


<muclient>
<plugin
   name="WMCypher"
   id="74a7fa967aab1f82743f9e5a"
   language="Lua"
   save_state="y"
   requires="4.91"
   version="1.0"
   >

</plugin>


<!--  Get our standard constants

<include name="constants.lua"/> -->

<!-- Triggers -->

<triggers>
  <trigger
   group="WMCypher"
   name="CypherDecoder"
   enabled="y"   
   match="\|\+\| (.+)&quot;$"
   regexp="y"
   script="wm.cypher.decode"
   sequence="100"
  >
  </trigger>
</triggers>

<!-- Aliases -->

<aliases>
  <alias
   group="WMCypher"
   name="CypherEncoder"
   match="^haencode (.+)$"
   enabled="y"
   regexp="y"
   ignore_case="y"
   script="wm.cypher.encode"
   sequence="100"
  >
  </alias> 
</aliases>

<!--  Script  -->

<script>
<![CDATA[ 

wm = wm or {}
wm.cypher = wm.cypher or {phrase = {},key = {}}
local thing =   "thequickbrownfoxjumpsoverthelazydog"
local tempkey = "1234567890abcdefghijklmnopqrstuvwxy"
 
for i = 1, #thing do 
	wm.cypher.phrase[#wm.cypher.phrase+1] = thing:sub(i,i) 
end
for i = 1, #tempkey do 
	wm.cypher.key[#wm.cypher.key+1] = tempkey:sub(i,i)
end
 
function wm.cypher.encode(name, line, wildcards)
		message = wildcards[1]
		message = string.lower(message)
        local mes = ""
        for i = 1,#message do
                if message:sub(i,i) == " " then
                        mes = mes .. " "
                elseif message:sub(i,i) == "," then
                        mes = mes .. ","
                elseif message:sub(i,i) == "." then
                        mes = mes .. "."
                elseif message:sub(i,i) == "?" then
                        mes = mes .. "?"
                else
						indexKey = indexOf(wm.cypher.phrase, message:sub(i,i))
                        mes = mes .. wm.cypher.key[indexKey]
                end
        end
        Send("clan ha tell |+| " .. mes)
end
 
function wm.cypher.decode(name, line, wildcards)
		message = wildcards[1]
		message = string.lower(message)
        local mes = ""
        for i = 1,#message do
                if message:sub(i,i) == " " then
                        mes = mes .. " "
                elseif message:sub(i,i) == "," then
                        mes = mes .. ","
                elseif message:sub(i,i) == "." then
                        mes = mes .. "."
                elseif message:sub(i,i) == "?" then
                        mes = mes .. "?"
                else
						indexKey = indexOf(wm.cypher.key, message:sub(i,i))
                        mes = mes .. wm.cypher.phrase[indexKey]
                end
        end
        Note("\n"..mes)
end


function indexOf(t, v)
		
	for key, value in pairs(t) do
		if value == v then
			return key
		end	
	end
end



]]>
</script>
</muclient>
